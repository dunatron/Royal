$(document).ready(function(){function e(e){"research"===e||"researchers"===e?($(".stuteach").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".research").addClass("panel-active")):"stuteach"===e||"teachersandstudents"===e?($(".research").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".stuteach").addClass("panel-active")):($(".research").removeClass("panel-active"),$(".stuteach").removeClass("panel-active"),$(".curious").addClass("panel-active"))}function t(t){e(t),$("#custom-slide-id .mobile-slide").empty(),$("#custom-slide-id .top-slide.tablet-slide").html("loading..."),$("#custom-slide-id .bottom-slide.tablet-slide").empty();var i=new Array;$(".panel-container.panel-active .panel-item").each(function(){i.push($(this).attr("panel-page-id"))}),$.ajax({url:"/home/SliderContent",data:"atype="+t+"&boxids="+JSON.stringify(i),method:"POST"}).done(function(e){$("#custom-slide-id .top-slide.tablet-slide").empty(),$("#custom-slide-id .bottom-slide.tablet-slide").empty(),$("#custom-slide-id .mobile-slide").html(e),s(),a(),"researchers"==t||"research"==t?$(".filter-buttons .filter-research").addClass("filter-active"):"teachersandstudents"==t||"stuteach"==t?$(".filter-buttons .filter-stuteach").addClass("filter-active"):$(".filter-buttons .filter-curious").addClass("filter-active")})}function i(e){$.ajax({url:"/home/SetAudienceCookie",method:"POST",data:"royalsocietyaudience="+e})}function s(){var e=[],t=[],i=[],s=0,n=0;if($(window).width()>=768){for(e=[],$(".mobile-slide").find(".project-item").each(function(){e.push('<li class="project-item">'+$(this).html()+"</li>")}),n=e.length,s=0;n>s;s+=4)$(".top-slide").append(e[s]),$(".top-slide").append(e[s+1]);for(s=2;n>s;s+=4)$(".bottom-slide").append(e[s]),$(".bottom-slide").append(e[s+1]);$(".mobile-slide").find(".project-item").each(function(){$(this).remove()})}else{for(t=[],i=[],n=0,$(".top-slide").find(".project-item").each(function(){t.push('<li class="project-item">'+$(this).html()+"</li>")}),$(".bottom-slide").find(".project-item").each(function(){i.push('<li class="project-item">'+$(this).html()+"</li>")}),n=t.length,s=0;n>s;s+=2)$(".mobile-slide").append(t[s]),$(".mobile-slide").append(t[s+1]),$(".mobile-slide").append(i[s]),$(".mobile-slide").append(i[s+1]);$(".top-slide").find(".project-item").each(function(){$(this).remove()}),$(".bottom-slide").find(".project-item").each(function(){$(this).remove()})}}function n(){var e=$(".custom-slide-container").width();return $(window).width()>=768?parseInt(e/3)+parseInt(e/3):parseInt(e)}function a(){var e=0,t=parseInt(n());$(window).width()>=768?($(".top-slide").find(".project-item").each(function(){$(this).css("width",t),$(this).css("left",e),e+=t}),e=0,$(".bottom-slide").find(".project-item").each(function(){$(this).css("width",t),$(this).css("left",e),e+=t})):$(".mobile-slide").find(".project-item").each(function(){$(this).css("width",t),$(this).css("top",e),e+=190})}function o(e){var t=0,i=0;if($(window).width()>=768){if("next"===e)$(".top-slide").find(".project-item").each(function(){i=parseInt($(this).css("left").replace("px",""))>=0?1:0,t+=i});else if("prev"===e){var s=n();$(".top-slide").find(".project-item").each(function(){i=parseInt($(this).css("left").replace("px",""))>=s?0:1,t+=i})}}else"next"===e?$(".mobile-slide").find(".project-item").each(function(){i=parseInt($(this).css("top").replace("px",""))<=190?0:1,t+=i}):"prev"===e&&$(".mobile-slide").find(".project-item").each(function(){i=parseInt($(this).css("top").replace("px",""))<=0?1:0,t+=i});return t}function c(){1==d&&($(".mobile-slide").find(".project-item").each(function(){d=!1;var e=o("prev");if(e>=2){var t=$(this).css("top").replace("px",""),i=parseInt(t)+190;$(".button-next").removeClass("button-next-remove"),$($(this)).animate({top:i+"px"},250,function(){d=!0})}else $(".button-prev").addClass("button-prev-remove"),d=!0}),$(".top-slide").find(".project-item").each(function(){d=!1;var e=o("prev"),t=n();if(e>1){var i=$(this).css("left").replace("px",""),s=parseInt(i)+t/2;$(".button-next").removeClass("button-next-remove"),$($(this)).animate({left:s+"px"},250,function(){d=!0})}else $(".button-prev").addClass("button-prev-remove"),d=!0;$(this).addClass("scrolled")}),$(".bottom-slide").find(".project-item").each(function(){d=!1;var e=o("prev"),t=n();if(e>1){var i=$(this).css("left").replace("px",""),s=parseInt(i)+t/2;$(".button-next").removeClass("button-next-remove"),$($(this)).animate({left:s+"px"},250,function(){d=!0})}else $(".button-prev").addClass("button-prev-remove"),d=!0;$(this).addClass("scrolled")}))}function r(){1==d&&($(".mobile-slide").find(".project-item").each(function(){d=!1;var e=o("next");if(e>=1){var t=$(this).css("top").replace("px",""),i=parseInt(t)-190;$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({top:i+"px"},250,function(){d=!0})}else $(".button-next").addClass("button-next-remove"),d=!0}),$(".top-slide").find(".project-item").each(function(){d=!1;var e=o("next"),t=n();if(e>1){var i=$(this).css("left").replace("px",""),s=parseInt(i)-t/2;$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:s+"px"},250,function(){d=!0})}else $(".button-next").addClass("button-next-remove"),d=!0;$(this).addClass("scrolled")}),$(".bottom-slide").find(".project-item").each(function(){d=!1;var e=o("next"),t=n();if(e>1){var i=$(this).css("left").replace("px",""),s=parseInt(i)-t/2;$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:s+"px"},250,function(){d=!0})}else $(".button-next").addClass("button-next-remove"),d=!0;$(this).addClass("scrolled")}))}$(".communities-trigger").click(function(){$(this).removeClass("desktop-land-trigger"),$(".communities-background").removeClass("desktop-land-expand"),$(this).hasClass("communities-trigger-active")?$(this).removeClass("communities-trigger-active"):$(this).addClass("communities-trigger-active"),$(".communities-background").hasClass("communities-background-active")?$(".communities-background").removeClass("communities-background-active"):$(".communities-background").addClass("communities-background-active")}),$(".filter").click(function(e){e.preventDefault(),$(".filter").removeClass("filter-active"),$(this).addClass("filter-active")}),t($("#audiencetype").val()),$(".filter-research").click(function(){var e="research";t(e),$("#audiencetype").val("researchers"),i("researchers")}),$(".filter-stuteach").click(function(){var e="stuteach";t(e),$("#audiencetype").val("teachersandstudents"),i("teachersandstudents")}),$(".filter-curious").click(function(){var e="curious";t(e),$("#audiencetype").val("all"),i("all")}),s(),a();var l=$(window).width();$(window).resize(function(){$(window).width()!=l&&(s(),a())});var d=!0;$(".button-next").click(function(){r()}),$(".button-prev").click(function(){c()});var p=document.getElementById("custom-slide-id"),u=new Hammer(p);u.on("swipeleft",function(){r()}),u.on("swiperight",function(){c()})});