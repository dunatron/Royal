!function($){$(document).ready(function(){function e(){$(".panel-img").width($(".panel-img-container").width()+10)}function t(){$(window).width()>=768?$(".panel-img-container").hover(function(){$(".backdrop-slide").removeClass("backdrop-slide-active"),$(this).find(".backdrop-slide").addClass("backdrop-slide-active")}):($(".panel-text").click(function(e){$(this).parent().hasClass("backdrop-slide-active")||e.preventDefault()}),$(".panel-img-container").click(function(){$(".backdrop-slide").removeClass("backdrop-slide-active"),$(this).find(".backdrop-slide").addClass("backdrop-slide-active")}))}function s(e){"research"===e||"researchers"===e?($(".stuteach").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".research").addClass("panel-active")):"stuteach"===e||"teachersandstudents"===e?($(".research").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".stuteach").addClass("panel-active")):($(".research").removeClass("panel-active"),$(".stuteach").removeClass("panel-active"),$(".curious").addClass("panel-active"))}function i(e){s(e),$("#custom-slide-id .top-slide.tablet-slide").empty(),$(".sliderloader").show(),$("#custom-slide-id .bottom-slide.tablet-slide").empty();var t=new Array;$(".panel-container.panel-active .panel-item").each(function(){t.push($(this).attr("panel-page-id"))}),$.ajax({url:"/homefunction/SliderContent",data:"atype="+e+"&boxids="+JSON.stringify(t),method:"POST"}).done(function(t){$("#custom-slide-id .top-slide.tablet-slide").empty(),$("#custom-slide-id .bottom-slide.tablet-slide").empty(),$(".sliderloader").hide();for(var s=t.split("</li>"),i=0,o=0,n="",r=0,d=0;d<s.length;d++)n=$.parseHTML(s[d]),o>=i?($(".hidden-slide-sort").append(n),r=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .top-slide.tablet-slide").append(n),i+=r):($(".hidden-slide-sort").append(n),r=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .bottom-slide.tablet-slide").append(n),o+=r);a(),"researchers"==e||"research"==e?$(".filter-buttons .filter-research").addClass("filter-active"):"teachersandstudents"==e||"stuteach"==e?$(".filter-buttons .filter-stuteach").addClass("filter-active"):$(".filter-buttons .filter-curious").addClass("filter-active")})}function o(e){$.ajax({url:"/homefunction/SetAudienceCookie",method:"POST",data:"royalsocietyaudience="+e})}function n(){var e=0;return $(window).width()>=768?(e=$(".custom-slide-container").width(),parseInt(e/3)+parseInt(e/3)):(e=$(".custom-slide-container").width(),parseInt(e))}function a(){var e=0;m=0,h=0,$(".button-next").addClass("button-next-remove"),$(".button-prev").addClass("button-prev-remove");var t=parseInt(n());$(".top-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),m+=parseInt($(this).css("width").replace("px",""))}),e=0,$(".bottom-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),h+=parseInt($(this).css("width").replace("px",""))}),m>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):h>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):$(".button-next").addClass("button-next-remove")}function r(e,t){return g="good",w=e.css("left").replace("px",""),j=e.width(),j==t?w==-t/2&&(g="bad"):j==t/2&&w==-t/2&&(g="bad"),g}function d(e,t){return g="good",w=e.css("left").replace("px",""),j=e.width(),j==t?t>=w&&(g="bad"):j==t/2&&t+t/2>=w&&(g="bad"),g}function l(){1==f&&($(".top-slide").find(".project-item").each(function(e,t){f=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),0==e&&(x=r($(this),s))}),$(".bottom-slide").find(".project-item").each(function(e,t){f=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),0==e&&(x=r($(this),s)),$(this).addClass("scrolled")})),"bad"==x&&$(".button-prev").addClass("button-prev-remove")}function c(){if(x="good",1==f){var e=0;$(".top-slide").find(".project-item").each(function(t,s){e=t}),$(".top-slide").find(".project-item").each(function(t,s){f=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)-i/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),t==e&&(k=d($(this),i)),$(this).addClass("scrolled")});var t=0;$(".bottom-slide").find(".project-item").each(function(e,s){t=e}),$(".bottom-slide").find(".project-item").each(function(e,s){f=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)-i/2,$(".button-next").removeClass("button-next-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),e==t&&(I=d($(this),i)),$(this).addClass("scrolled")})}"bad"==k&&"bad"==I&&$(".button-next").addClass("button-next-remove")}function u(e){$("#custom-slide-id .top-slide.tablet-slide").empty(),$(".sliderloader").show(),$("#custom-slide-id .bottom-slide.tablet-slide").empty(),$.ajax({url:"/microsite/SliderContent",data:"atype="+e,method:"POST"}).done(function(e){$("#custom-slide-id .top-slide.tablet-slide").empty(),$("#custom-slide-id .bottom-slide.tablet-slide").empty(),$(".sliderloader").hide();for(var t=e.split("</li>"),s=0,i=0,o="",n=0,r=0;r<t.length;r++)o=$.parseHTML(t[r]),i>=s?($(".hidden-slide-sort").append(o),n=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .top-slide.tablet-slide").append(o),s+=n):($(".hidden-slide-sort").append(o),n=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .bottom-slide.tablet-slide").append(o),i+=n);a()})}function n(){var e=0;return $(window).width()>=768?(e=$(".custom-slide-container").width(),parseInt(e/3)+parseInt(e/3)):(e=$(".custom-slide-container").width(),parseInt(e))}function a(){var e=0;m=0,h=0,$(".button-next").addClass("button-next-remove"),$(".button-prev").addClass("button-prev-remove");var t=parseInt(n());$(".top-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),m+=parseInt($(this).css("width").replace("px",""))}),e=0,$(".bottom-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),h+=parseInt($(this).css("width").replace("px",""))}),m>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):h>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):$(".button-next").addClass("button-next-remove")}function r(e,t){return g="good",w=e.css("left").replace("px",""),j=e.width(),j==t?w==-t/2&&(g="bad"):j==t/2&&w==-t/2&&(g="bad"),g}function d(e,t){return g="good",w=e.css("left").replace("px",""),j=e.width(),j==t?t>=w&&(g="bad"):j==t/2&&t+t/2>=w&&(g="bad"),g}function l(){1==f&&($(".top-slide").find(".project-item").each(function(e,t){f=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),0==e&&(x=r($(this),s))}),$(".bottom-slide").find(".project-item").each(function(e,t){f=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),0==e&&(x=r($(this),s)),$(this).addClass("scrolled")})),"bad"==x&&$(".button-prev").addClass("button-prev-remove")}function c(){if(x="good",1==f){var e=0;$(".top-slide").find(".project-item").each(function(t,s){e=t}),$(".top-slide").find(".project-item").each(function(t,s){f=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)-i/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),t==e&&(k=d($(this),i)),$(this).addClass("scrolled")});var t=0;$(".bottom-slide").find(".project-item").each(function(e,s){t=e}),$(".bottom-slide").find(".project-item").each(function(e,s){f=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),b=$(this).css("left").replace("px",""),C=parseInt(b)-i/2,$(".button-next").removeClass("button-next-remove"),$($(this)).animate({left:C+"px"},250,function(){f=!0}),e==t&&(I=d($(this),i)),$(this).addClass("scrolled")})}"bad"==k&&"bad"==I&&$(".button-next").addClass("button-next-remove")}function p(){console.log("changed"+T+" "+U+" "+A+" "),S.prop("checked")?(H="TBC",N="TBC",$("#orderFormUnitShipping").text(H),$("#orderFormUnitTotal").text(N),$(".qty-label").removeClass("hide")):(H="NZ"==_.val()?T:"AU"==_.val()?U:A,N=parseInt(H)+parseInt(B),console.log(H+" "+B),$(".qty-label").addClass("hide"),$("#orderFormUnitShipping").text("$"+H),$("#orderFormUnitTotal").text("$"+N.toFixed(2)))}if($("[placeholder]").focus(function(){var e=$(this);e.val()===e.attr("placeholder")&&(e.val(""),e.removeClass("placeholder"))}).blur(function(){var e=$(this);""!==e.val()&&e.val()!=e.attr("placeholder")||(e.addClass("placeholder"),e.val(e.attr("placeholder")))}).blur(),$(".hamburger").on("click",function(e){e.preventDefault(),alert("hamburger clicked"),$(".filling").addClass("filling-animate")}),$(".homepage").length){$(".communities-trigger").click(function(){$(this).removeClass("desktop-land-trigger"),$(".communities-background").removeClass("desktop-land-expand"),$(this).hasClass("communities-trigger-active")?$(this).removeClass("communities-trigger-active"):$(this).addClass("communities-trigger-active"),$(".communities-background").hasClass("communities-background-active")?$(".communities-background").removeClass("communities-background-active"):$(".communities-background").addClass("communities-background-active")}),$(".filter").click(function(e){e.preventDefault(),$(".filter").removeClass("filter-active"),$(this).addClass("filter-active")}),e(),t(),$(".filter-research").click(function(){var e="research";i(e),$("#audiencetype").val("researchers"),o("researchers")}),$(".filter-stuteach").click(function(){var e="stuteach";i(e),$("#audiencetype").val("teachersandstudents"),o("teachersandstudents")}),$(".filter-curious").click(function(){var e="curious";i(e),$("#audiencetype").val("all"),o("all")}),i($("#audiencetype").val());var m=0,h=0;a();var v=$(window).width();$(window).resize(function(){$(window).width()!=v&&(a(),e(),t())});var f=!0,b=0,C=0,x="good",g="good",w=0,j=0,k="good",I="good";$(".button-next").click(function(){c()}),$(".button-prev").click(function(){l()});var y=document.getElementById("custom-slide-id"),F=new Hammer(y);F.on("swipeleft",function(){c()}),F.on("swiperight",function(){l()})}else if($(".microsite").length){var m=0,h=0;u($("#micrositetag").val()),a();var v=$(window).width();$(window).resize(function(){$(window).width()!=v&&a()});var f=!0,b=0,C=0,x="good",g="good",w=0,j=0,k="good",I="good";$(".button-next").click(function(){c()}),$(".button-prev").click(function(){l()});var y=document.getElementById("custom-slide-id"),F=new Hammer(y);F.on("swipeleft",function(){c()}),F.on("swiperight",function(){l()})}var _=$("#Form_BookForm_Shipping"),S=$("#Form_BookForm_QtyCheck"),B=$("#Form_BookForm_UnitPrice").val(),T=$("#Form_BookForm_ShipNZ").val(),U=$("#Form_BookForm_ShipAUS").val(),A=$("#Form_BookForm_shipINTER").val(),H=0,N=0;$(_).on("change",function(){p()}),$(S).on("change",function(){p()}),p()})}(jQuery_1_12_4);