$(document).ready(function(){function e(){$(".panel-img").width($(".panel-img-container").width()+10)}function t(){$(window).width()>=768?$(".panel-img-container").hover(function(){$(".backdrop-slide").removeClass("backdrop-slide-active"),$(this).find(".backdrop-slide").addClass("backdrop-slide-active")}):($(".panel-text").click(function(e){$(this).parent().hasClass("backdrop-slide-active")||e.preventDefault()}),$(".panel-img-container").click(function(){$(".backdrop-slide").removeClass("backdrop-slide-active"),$(this).find(".backdrop-slide").addClass("backdrop-slide-active")}))}function s(e){"research"===e||"researchers"===e?($(".stuteach").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".research").addClass("panel-active")):"stuteach"===e||"teachersandstudents"===e?($(".research").removeClass("panel-active"),$(".curious").removeClass("panel-active"),$(".stuteach").addClass("panel-active")):($(".research").removeClass("panel-active"),$(".stuteach").removeClass("panel-active"),$(".curious").addClass("panel-active"))}function i(e){s(e),$("#custom-slide-id .top-slide.tablet-slide").empty(),$(".sliderloader").show(),$("#custom-slide-id .bottom-slide.tablet-slide").empty();var t=new Array;$(".panel-container.panel-active .panel-item").each(function(){t.push($(this).attr("panel-page-id"))}),$.ajax({url:"/homefunction/SliderContent",data:"atype="+e+"&boxids="+JSON.stringify(t),method:"POST"}).done(function(t){$("#custom-slide-id .top-slide.tablet-slide").empty(),$("#custom-slide-id .bottom-slide.tablet-slide").empty(),$(".sliderloader").hide();for(var s=t.split("</li>"),i=0,a=0,n="",r=0,d=0;d<s.length;d++)n=$.parseHTML(s[d]),a>=i?($(".hidden-slide-sort").append(n),r=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .top-slide.tablet-slide").append(n),i+=r):($(".hidden-slide-sort").append(n),r=$(".hidden-slide-sort").find(".project-image").hasClass("no-image")?1:2,$(".hidden-slide-sort").find(".project-item").remove(),$("#custom-slide-id .bottom-slide.tablet-slide").append(n),a+=r);o(),"researchers"==e||"research"==e?$(".filter-buttons .filter-research").addClass("filter-active"):"teachersandstudents"==e||"stuteach"==e?$(".filter-buttons .filter-stuteach").addClass("filter-active"):$(".filter-buttons .filter-curious").addClass("filter-active")})}function a(e){$.ajax({url:"/homefunction/SetAudienceCookie",method:"POST",data:"royalsocietyaudience="+e})}function n(){var e=0;return $(window).width()>=768?(e=$(".custom-slide-container").width(),parseInt(e/3)+parseInt(e/3)):(e=$(".custom-slide-container").width(),parseInt(e))}function o(){var e=0;u=0,p=0,$(".button-next").addClass("button-next-remove"),$(".button-prev").addClass("button-prev-remove");var t=parseInt(n());$(".top-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),u+=parseInt($(this).css("width").replace("px",""))}),e=0,$(".bottom-slide").find(".project-item").each(function(){$(this).find(".project-image").hasClass("no-image")&&($(this).find(".project-image").addClass("hide"),$(this).find(".project-text").removeClass("sml-col-6"),t/=2),$(this).css("width",t),$(this).css("left",e),e+=t,t=parseInt(n()),p+=parseInt($(this).css("width").replace("px",""))}),u>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):p>$(".custom-slide-container").width()?$(".button-next").removeClass("button-next-remove"):$(".button-next").addClass("button-next-remove")}function r(e,t){return C="good",g=e.css("left").replace("px",""),x=e.width(),x==t?g==-t/2&&(C="bad"):x==t/2&&g==-t/2&&(C="bad"),C}function d(e,t){return C="good",g=e.css("left").replace("px",""),x=e.width(),x==t?t>=g&&(C="bad"):x==t/2&&t+t/2>=g&&(C="bad"),C}function c(){1==v&&($(".top-slide").find(".project-item").each(function(e,t){v=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),h=$(this).css("left").replace("px",""),f=parseInt(h)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:f+"px"},250,function(){v=!0}),0==e&&(b=r($(this),s))}),$(".bottom-slide").find(".project-item").each(function(e,t){v=!1;var s=n();$(".button-prev").addClass("button-prev-remove"),$(".button-next").removeClass("button-next-remove"),h=$(this).css("left").replace("px",""),f=parseInt(h)+s/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:f+"px"},250,function(){v=!0}),0==e&&(b=r($(this),s)),$(this).addClass("scrolled")})),"bad"==b&&$(".button-prev").addClass("button-prev-remove")}function l(){if(b="good",1==v){var e=0;$(".top-slide").find(".project-item").each(function(t,s){e=t}),$(".top-slide").find(".project-item").each(function(t,s){v=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),h=$(this).css("left").replace("px",""),f=parseInt(h)-i/2,$(".button-prev").removeClass("button-prev-remove"),$($(this)).animate({left:f+"px"},250,function(){v=!0}),t==e&&(w=d($(this),i)),$(this).addClass("scrolled")});var t=0;$(".bottom-slide").find(".project-item").each(function(e,s){t=e}),$(".bottom-slide").find(".project-item").each(function(e,s){v=!1;var i=n();$(".button-next").addClass("button-next-remove"),$(".button-prev").removeClass("button-prev-remove"),h=$(this).css("left").replace("px",""),f=parseInt(h)-i/2,$(".button-next").removeClass("button-next-remove"),$($(this)).animate({left:f+"px"},250,function(){v=!0}),e==t&&(k=d($(this),i)),$(this).addClass("scrolled")})}"bad"==w&&"bad"==k&&$(".button-next").addClass("button-next-remove")}$(".communities-trigger").click(function(){$(this).removeClass("desktop-land-trigger"),$(".communities-background").removeClass("desktop-land-expand"),$(this).hasClass("communities-trigger-active")?$(this).removeClass("communities-trigger-active"):$(this).addClass("communities-trigger-active"),$(".communities-background").hasClass("communities-background-active")?$(".communities-background").removeClass("communities-background-active"):$(".communities-background").addClass("communities-background-active")}),$(".filter").click(function(e){e.preventDefault(),$(".filter").removeClass("filter-active"),$(this).addClass("filter-active")}),e(),t(),$(".filter-research").click(function(){var e="research";i(e),$("#audiencetype").val("researchers"),a("researchers")}),$(".filter-stuteach").click(function(){var e="stuteach";i(e),$("#audiencetype").val("teachersandstudents"),a("teachersandstudents")}),$(".filter-curious").click(function(){var e="curious";i(e),$("#audiencetype").val("all"),a("all")}),i($("#audiencetype").val());var u=0,p=0;o();var m=$(window).width();$(window).resize(function(){$(window).width()!=m&&(o(),e(),t())});var v=!0,h=0,f=0,b="good",C="good",g=0,x=0,w="good",k="good";$(".button-next").click(function(){l()}),$(".button-prev").click(function(){c()});var j=document.getElementById("custom-slide-id"),y=new Hammer(j);y.on("swipeleft",function(){l()}),y.on("swiperight",function(){c()})});